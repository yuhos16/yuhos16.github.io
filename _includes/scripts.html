<script src="assets/js/main.min.js"></script>

{% include analytics.html %}
{% include fetch_google_scholar_stats.html %}
<script>
  (function(){
    function getPreferredTheme(){
      var saved = localStorage.getItem('theme');
      if(saved === 'dark' || saved === 'light') return saved;
      return window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
    }
    function applyTheme(theme){
      var root = document.documentElement;
      var toggle = document.getElementById('theme-toggle');
      if(theme === 'dark'){
        root.classList.add('theme-dark');
        if(toggle) toggle.textContent = 'Light';
      } else {
        root.classList.remove('theme-dark');
        if(toggle) toggle.textContent = 'Dark';
      }
      localStorage.setItem('theme', theme);
    }
    document.addEventListener('DOMContentLoaded', function(){
      applyTheme(getPreferredTheme());
      document.addEventListener('click', function(e){
        var t = e.target;
        if(t && t.id === 'theme-toggle'){
          e.preventDefault();
          applyTheme(document.documentElement.classList.contains('theme-dark') ? 'light' : 'dark');
        }
      });
    });
  })();
</script>
